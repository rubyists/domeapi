= Domeapi
:toc: macro

Ruby client for the Domeapi API.

== Installation

Install the gem and add to the application's Gemfile by executing:

[source,bash]
----
bundle add domeapi
----

If bundler is not being used to manage dependencies, install the gem by executing:

[source,bash]
----
gem install domeapi
----

== Usage

=== Configuration

Configure the gem with your API key. You can set it via the `DOMEAPI_API_KEY` environment variable or configure it explicitly:

[source,ruby]
----
Rubyists::Domeapi.configure do |config|
  config.api_key = 'your_api_key'
end
----

=== Client

Initialize the client:

[source,ruby]
----
client = Rubyists::Domeapi.client
----

=== Polymarket

Access Polymarket endpoints via the `polymarket` namespace.

==== Markets

https://docs.domeapi.io/api-reference/endpoint/get-markets[API Reference]

List markets with optional filtering:

[source,ruby]
----
# List markets with default filter
markets = client.polymarket.markets.list

# List markets with custom filter
markets = client.polymarket.markets.list(limit: 10, offset: 0, status: 'open')
----

Get market price:

[source,ruby]
----
price = client.polymarket.markets.price(token_id: 'token_id')
----

==== Candlesticks

https://docs.domeapi.io/api-reference/endpoint/get-candlesticks[API Reference]

Get candlesticks:

[source,ruby]
----
candlesticks = client.polymarket.candlesticks.list(
  condition_id: 'condition_id',
  start_time: 1625097600,
  end_time: 1625184000,
  interval: 60
)
----

==== Trade History

https://docs.domeapi.io/api-reference/endpoint/get-trade-history[API Reference]

Get trade history:

[source,ruby]
----
trades = client.polymarket.trade_history.list(
  market_slug: 'market_slug',
  limit: 10
)
----

==== Orderbook

https://docs.domeapi.io/api-reference/endpoint/get-orderbook-history[API Reference]

Get orderbook history:

[source,ruby]
----
snapshots = client.polymarket.orderbook.list(
  token_id: 'token_id',
  start_time: 1625097600000,
  end_time: 1625184000000
)
----

==== Activity

https://docs.domeapi.io/api-reference/endpoint/get-activity[API Reference]

Get activity:

[source,ruby]
----
activity = client.polymarket.activity.list(
  user: '0x...',
  limit: 10
)
----

==== Market Price

https://docs.domeapi.io/api-reference/endpoint/get-market-price[API Reference]

Get market price history:

[source,ruby]
----
prices = client.polymarket.market_price.list(
  token_id: 'token_id',
  at_time: 1625097600
)
----

==== Wallet

https://docs.domeapi.io/api-reference/endpoint/get-wallet[API Reference]

Get wallet information:

[source,ruby]
----
wallet = client.polymarket.wallet.list(
  eoa: '0x...'
)
----

==== Wallet Profit and Loss

https://docs.domeapi.io/api-reference/endpoint/get-wallet-pnl[API Reference]

Get wallet profit and loss:

[source,ruby]
----
pnl = client.polymarket.wallet_profit_and_loss.list(
  wallet_address: '0x...',
  granularity: 'day'
)
----

=== Matching Markets

Access Matching Markets endpoints via the `matching_markets` namespace.

==== Sports

https://docs.domeapi.io/api-reference/endpoint/get-matching-markets-sports[API Reference]

List matching markets for a specific sport and date:

[source,ruby]
----
# Using dynamic methods
markets = client.matching_markets.nfl_on(Date.today)
markets = client.matching_markets.nba_on('2023-12-25')

# Using sports_by_date method
markets = client.matching_markets.sports_by_date(sport: 'nfl', date: Date.today)
----

==== Markets

https://docs.domeapi.io/api-reference/endpoint/get-matching-markets[API Reference]

List matching markets by slug or ticker:

[source,ruby]
----
# By Polymarket slug
markets = client.matching_markets.sports(polymarket_market_slug: 'super-bowl-lviii-winner')

# By Kalshi ticker
markets = client.matching_markets.sports(kalshi_event_ticker: 'SB58')
----

== Development

After checking out the repo, run `bin/setup` to install dependencies. Then, run `rake test` to run the tests. You can also run `bin/console` for an interactive prompt that will allow you to experiment.

To install this gem onto your local machine, run `bundle exec rake install`. To release a new version, update the version number in `version.rb`, and then run `bundle exec rake release`, which will create a git tag for the version, push git commits and the created tag, and push the `.gem` file to [rubygems.org](https://rubygems.org).

== Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/rubyists/domeapi.
